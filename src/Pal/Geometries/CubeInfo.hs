{-# LANGUAGE RecordWildCards #-}

module Pal.Geometries.CubeInfo where

import Graphics.GL

import Pal.ArrayBuffer
import Pal.Types

import Pal.Geometries.Plane

cubeGeometry :: GLfloat -> IO Geometry
cubeGeometry scale  = do


  -----------------
  -- Cube Positions
  -----------------
  
  -- Buffer the cube vertices
  positions <- bufferData $ map ( * scale )


      -- front
      [ -1.0 ,  1.0 ,  1.0
      , -1.0 , -1.0 ,  1.0 
      ,  1.0 ,  1.0 ,  1.0

      ,  1.0 , -1.0 ,  1.0
      ,  1.0 ,  1.0 ,  1.0
      , -1.0 , -1.0 ,  1.0


      -- right
      ,  1.0 ,  1.0 ,  1.0
      ,  1.0 , -1.0 ,  1.0
      ,  1.0 ,  1.0 , -1.0

      ,  1.0 , -1.0 , -1.0
      ,  1.0 ,  1.0 , -1.0
      ,  1.0 , -1.0 ,  1.0

      -- back
      ,  1.0 ,  1.0 , -1.0
      ,  1.0 , -1.0 , -1.0
      , -1.0 ,  1.0 , -1.0

      , -1.0 , -1.0 , -1.0
      , -1.0 ,  1.0 , -1.0
      ,  1.0 , -1.0 , -1.0

      -- left
      , -1.0 ,  1.0 , -1.0
      , -1.0 , -1.0 , -1.0
      , -1.0 ,  1.0 ,  1.0

      , -1.0 , -1.0 ,  1.0
      , -1.0 ,  1.0 ,  1.0
      , -1.0 , -1.0 , -1.0


      -- top
      , -1.0 ,  1.0 , -1.0
      , -1.0 ,  1.0 ,  1.0
      ,  1.0 ,  1.0 , -1.0

      ,  1.0 ,  1.0 ,  1.0
      ,  1.0 ,  1.0 , -1.0
      , -1.0 ,  1.0 ,  1.0


      -- bottom
      , -1.0 , -1.0 ,  1.0
      , -1.0 , -1.0 , -1.0
      ,  1.0 , -1.0 , -1.0

      ,  1.0 , -1.0 , -1.0
      ,  1.0 , -1.0 ,  1.0
      , -1.0 , -1.0 ,  1.0 ]



  -----------------
  -- Cube Normals
  -----------------

  --normals <- bufferData $ take ( 18 * 6 ) $ cycle [0,0,1]
  
  -- Buffer the cube vertices
  normals <- bufferData


      -- front
      [  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0

      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0


      -- right
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      -- back
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0

      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0

      -- left
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0

      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0


      -- top
      ,  0.0 ,  1.0 ,  0.0
      ,  0.0 ,  1.0 ,  0.0
      ,  0.0 ,  1.0 ,  0.0
      
      ,  0.0 ,  1.0 ,  0.0
      ,  0.0 ,  1.0 ,  0.0
      ,  0.0 ,  1.0 ,  0.0

      -- bottom
      ,  0.0 , -1.0 ,  0.0
      ,  0.0 , -1.0 ,  0.0
      ,  0.0 , -1.0 ,  0.0
       
      ,  0.0 , -1.0 ,  0.0
      ,  0.0 , -1.0 ,  0.0
      ,  0.0 , -1.0 ,  0.0 ]

  -----------------
  -- Cube Tangents
  -----------------

  -- Buffer the cube vertices
  tangents <- bufferData

      -- front
      [  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      -- right
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0

      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0
      ,  0.0 ,  0.0 , -1.0

      -- back
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0

      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0

      -- left
      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0

      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0
      ,  0.0 ,  0.0 ,  1.0

      -- top
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0
      ,  1.0 ,  0.0 ,  0.0

      -- bottom
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0

      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0
      , -1.0 ,  0.0 ,  0.0 ]



  -----------------
  -- Cube UVs
  -----------------

  -- Buffer the cube vertices
  uvs <- bufferData  

      -- front
      [  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  1.0

      ,  1.0 ,  0.0 
      ,  1.0 ,  1.0 
      ,  0.0 ,  0.0 

      -- right
      ,  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  1.0

      ,  1.0 ,  0.0 
      ,  1.0 ,  1.0 
      ,  0.0 ,  0.0 

      -- back
      ,  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  1.0

      ,  1.0 ,  0.0 
      ,  1.0 ,  1.0 
      ,  0.0 ,  0.0 

      -- left
      ,  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  1.0

      ,  1.0 ,  0.0 
      ,  1.0 ,  1.0 
      ,  0.0 ,  0.0 

      -- top
      ,  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  1.0

      ,  1.0 ,  0.0 
      ,  1.0 ,  1.0 
      ,  0.0 ,  0.0 

      -- bottom
      ,  0.0 ,  1.0
      ,  0.0 ,  0.0
      ,  1.0 ,  0.0


      ,  1.0 ,  0.0
      ,  1.0 ,  1.0 
      ,  0.0 ,  1.0  ]

  let vertCount = 3 * 2 * 6

  return Geometry{..} 



